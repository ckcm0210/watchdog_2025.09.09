# Excel Watchdog 調試指南

## 如何啟用詳細調試功能

1. 打開程式設定視窗
2. 切換到「除錯與診斷」分頁
3. 設定以下選項：
   - **顯示除錯訊息** - 開啟基本的調試信息顯示
   - **顯示檔案詳細資訊** - 顯示檔案大小、修改時間等
   - **顯示記憶體使用資訊** - 顯示程式記憶體用量
   - **顯示垃圾回收資訊** - 顯示對象回收情況
   - **除錯日誌資料夾** - 設定錯誤報告存放位置

## 調試信息說明

啟用除錯後，會看到類似以下格式的調試信息：

### 檔案資訊
```
[file-info] 大小: 12.6 MB
[file-info] 修改時間: 2025-09-05 21:26:15
[file-info] 存取時間: 2025-09-05 21:26:15
[file-info] 存取間隔: 0.02 秒
```

### 記憶體使用
```
[memory] 讀取前: 156.25 MB
[memory] 讀取後: 182.70 MB
```

### 垃圾回收
```
[gc] 回收前對象: (1245, 412, 10), 回收後: (1224, 398, 0), 釋放: 28
[gc-說明] 第0代 (新對象): 1245->1224
[gc-說明] 第1代 (中年對象): 412->398
[gc-說明] 第2代 (老對象): 10->0
```

### 警告信息
```
[warning] 記憶體增長過大: +126.45 MB
[warning] 打開檔案數過多: 78
```

## 錯誤報告

當程式崩潰時，詳細的錯誤報告會保存到「除錯日誌資料夾」中，格式為：
```
crash_YYYYMMDD_HHMMSS.log
```

報告包含：
- 崩潰時間和類型
- 堆棧跟踪
- 系統信息
- 記憶體使用情況
- 打開的檔案列表

## 常見問題解決

1. **看不到調試信息**
   - 確認已安裝 `psutil` 套件：`pip install psutil`
   - 確保「顯示除錯訊息」已開啟
   - 檢查控制台輸出是否被重定向

2. **程式突然關閉**
   - 檢查「除錯日誌資料夾」中是否有崩潰報告
   - 分析報告中的堆棧跟踪和記憶體信息

3. **記憶體使用過高**
   - 監控「記憶體使用資訊」中的增長趨勢
   - 關注「垃圾回收資訊」中是否有足夠的對象被釋放

## 調試腳本

您還可以運行程式根目錄中的 `test_debug_messages.py` 腳本，檢測調試系統是否正常工作。